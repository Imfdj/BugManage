webpackJsonp([5],{"0czL":function(e,t,a){a("IjQa"),e.exports=a("AKd3").Number.isFinite},"7Otq":function(e,t,a){e.exports=a.p+"static/img/logo.0ba8a11.png"},"HM+b":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("3cXf"),i=a.n(r),o=(a("hRKE"),a("Mhc3")),s=a.n(o),l=a("vomx"),n={name:"bug",components:{},data:function(){return{baseUrl:this.$intfcUrl,ProjectID:localStorage.getItem("Bug_ProjectID"),TeamID:localStorage.getItem("Bug_TeamID"),Bug_LoginUser:JSON.parse(localStorage.getItem("Bug_LoginUser")),dialogCreatBugVisible:!1,creatBug_form:{PriorityLevel:"低",ModuleID:null,ProjectVerID:null,ProcessingPerson:null,NeedTime:"",TaskType:"开发"},ProjectVer_options:[],Module_options:[],ProcessingPerson_options:[],radio2:3,project_selected:"",options_project:[],activeIndex:"/bug/situation",isSendAllPeople:!1,rules3:{NeedTime:[{validator:function(e,t,a){s()(t-0)?a():a(new Error("请输入数字值"))},trigger:"blur"}]}}},beforeMount:function(){var e=this.$store.state.copy_bug_data;e&&(this.creatBug_form=e,this.creatBug_form.ProcessingPerson=this.creatBug_form.ProcessingPerson_ID,this.dialogCreatBugVisible=!0,this.$store.commit("updateCopy_bug_data",null)),this.activeIndex=this.$route.path},mounted:function(){this.GetProject(),this.ProjectID},methods:{dialogCreatBugVisibleClose:function(){this.creatBug_form={PriorityLevel:"低",ModuleID:null,ProjectVerID:null,ProcessingPerson:null,describeImageCotent:"",NeedTime:"",TaskType:"开发"},this.isSendAllPeople=!1,this.$refs.numberValidateForm.resetFields()},dialogCreatBugVisibleOpen:function(){this.creatBug_form.ModuleID=this.Module_options[0]&&this.Module_options[0].ModuleID,this.creatBug_form.ProjectVerID=this.ProjectVer_options[0]&&this.ProjectVer_options[0].ProjectVerID,this.creatBug_form.ProcessingPerson=this.Bug_LoginUser.EmployeeID,this.$nextTick(function(){})},project_selectedChange:function(e){var t=this,a=t.$route.path,r=a.substr(a.lastIndexOf("/")+1);t.options_project.forEach(function(a,r){if(a.ProjectID===e)return localStorage.setItem("Bug_TeamID",a.TeamID),void(t.TeamID=a.TeamID)}),l.a.$emit(r,e),localStorage.setItem("Bug_ProjectID",e),t.ProjectID=e,t.ProjectID&&(t.GetProjectVerson(t.ProjectID),t.GetProjectModule(t.ProjectID),t.GetMember(t.ProjectID,t.TeamID))},getProject_selected:function(){var e=localStorage.getItem("Bug_ProjectID"),t="";this.options_project.forEach(function(a,r){e==a.ProjectID&&(t=a.ProjectName)}),this.project_selected=t},handleSelect:function(e,t){var a=this.$route.path,r=a.substr(a.lastIndexOf("/")+1);r===(e=e.substr(e.lastIndexOf("/")+1))&&l.a.$emit(r,this.ProjectID)},creatBug:function(){this.dialogCreatBugVisible=!0},bugSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=JSON.parse(localStorage.getItem("Bug_LoginUser")).CompanyCode,r=JSON.parse(localStorage.getItem("Bug_LoginUser")).EmployeeID,i=t.ProjectID;if(a&&i){var o=function(e){var t=document.createElement("div");null!=t.textContent?t.textContent=e:t.innerText=e;var a=t.innerHTML;return t=null,a}(t.creatBug_form.describeImageCotent),s={CompanyCode:a,ProjectID:i,BugTitle:t.creatBug_form.BugTitle,ProjectVerID:t.creatBug_form.ProjectVerID,ModuleID:t.creatBug_form.ModuleID,PriorityLevel:t.creatBug_form.PriorityLevel,ProcessingPerson:t.creatBug_form.ProcessingPerson,describeImageCotent:o,CMaker:r,BugState:"未修复",NeedTime:t.creatBug_form.NeedTime,TaskType:t.creatBug_form.TaskType||""};r==t.creatBug_form.ProcessingPerson?t.$confirm("是否确认安排你本人处理当前问题?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.AddBugInfo(s)}).catch(function(){}):t.AddBugInfo(s)}})},SendEmail:function(e,t,a,r,i){var o=window.location.href;o=o.substr(0,o.indexOf("#/")-1)+"/bugInfo/"+r;var s=null;this.ProcessingPerson_options.forEach(function(e,a){if(e.EmployeeID==t)return s=e.MemberID,!1}),this.$http.post(this.baseUrl+"/Services/BugAssignServices.ashx?method=SendEmail",{ProjectID:e,MemberID:s,Getall:!0===a?1:0,address:o,isUpdate:i}).then(function(e){e.data}).catch(function(e){})},GetProject:function(){var e=this;e.$http.get(e.baseUrl+"/static/data/GetProject.json",{params:{}}).then(function(t){t.data.code>0?(e.options_project=t.data.data,e.getProject_selected()):e.options_project=[]}).catch(function(e){})},AddBugInfo:function(e){var t=this;t.$http.post(t.baseUrl+"/Services/BugManageServices.ashx?method=AddBugInfo",{jsondata:i()(e)}).then(function(a){if(a.data.code>0){var r=t.$route.path,i=r.substr(r.lastIndexOf("/")+1);l.a.$emit(i,t.ProjectID),t.SendEmail(e.ProjectID,e.ProcessingPerson,t.isSendAllPeople,a.data.data,1),t.dialogCreatBugVisible=!1,t.$message({message:"创建成功",type:"success"})}else t.$message({message:"创建失败",type:"error"})}).catch(function(e){t.$message({message:"创建失败",type:"error"})})},GetProjectVerson:function(e){var t=this;t.$http.get(t.baseUrl+"/Services/BugAssignServices.ashx?",{params:{method:"GetProjectVerson",ProjectID:e}}).then(function(e){e.data.code>0?(t.ProjectVer_options=e.data.data,t.$store.state.ProjectVer_options=e.data.data):t.ProjectVer_options=[]}).catch(function(e){})},GetProjectModule:function(e){var t=this;t.$http.get(t.baseUrl+"/Services/BugAssignServices.ashx?",{params:{method:"GetProjectModule",ProjectID:e}}).then(function(e){e.data.code>0?(t.Module_options=e.data.data,t.$store.state.Module_options=e.data.data):t.Module_options=[]}).catch(function(e){})},GetMember:function(e,t){var a=this;a.$http.get(a.baseUrl+"/Services/BugManageServices.ashx?",{params:{method:"GetMember",TeamID:t,ProjectID:e}}).then(function(e){e.data.code>0?a.ProcessingPerson_options=e.data.data:a.ProcessingPerson_options=[]}).catch(function(e){})}},watch:{ProjectID:function(e,t){},$route:function(e,t){this.activeIndex=e.path}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",{staticClass:"row-bg",staticStyle:{margin:"0px"},attrs:{type:"flex",justify:"space-between"}},[r("el-col",{staticStyle:{display:"flex"}},[r("div",{staticStyle:{display:"inline-block","margin-left":"20px"}},[r("img",{attrs:{src:a("7Otq"),alt:"",width:"80px",height:"80px"}})]),e._v(" "),r("div",{staticStyle:{display:"inline-block",padding:"20px"}},[r("el-select",{staticStyle:{"min-width":"270px"},attrs:{filterable:"",placeholder:"请选择"},on:{change:e.project_selectedChange},model:{value:e.project_selected,callback:function(t){e.project_selected=t},expression:"project_selected"}},e._l(e.options_project,function(e){return r("el-option",{key:e.ProjectID,attrs:{label:e.ProjectName,value:e.ProjectID}})}))],1),e._v(" "),r("div",{staticStyle:{display:"inline-block",padding:"20px","padding-left":"0px"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.creatBug}},[e._v("提交Bug")])],1)]),e._v(" "),r("el-col",{staticStyle:{"margin-right":"13px"}},[r("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal",router:!0},on:{select:e.handleSelect}},[r("el-menu-item",{attrs:{index:"/bug/bugStatistics"}},[r("div",{staticClass:"menu-icon-div"},[r("div",{staticClass:"menu-icon-div"},[r("i",{staticClass:"fa fa-signal menu-icon",staticStyle:{color:"rgb(10, 174, 84)"},attrs:{"aria-hidden":"true"}})])]),e._v(" "),r("span",{staticClass:"menu-title"},[e._v("Bug统计")])]),e._v(" "),r("el-menu-item",{attrs:{index:"/bug/allBug"}},[r("div",{staticClass:"menu-icon-div"},[r("div",{staticClass:"myCreatBug allBug menu-icon"},[r("i",{staticClass:"fa fa-bug bug-i-1",staticStyle:{color:"rgb(10, 174, 84)"},attrs:{"aria-hidden":"true"}}),e._v(" "),r("i",{staticClass:"fa fa-bug bug-i-2",staticStyle:{color:"rgb(10, 174, 84)"},attrs:{"aria-hidden":"true"}}),e._v(" "),r("i",{staticClass:"fa fa-bug bug-i-3",staticStyle:{color:"rgb(10, 174, 84)"},attrs:{"aria-hidden":"true"}})])]),e._v(" "),r("span",{staticClass:"menu-title"},[e._v("所有Bug")])]),e._v(" "),r("el-menu-item",{attrs:{index:"/bug/mySubmit"}},[r("div",{staticClass:"menu-icon-div"},[r("div",{staticClass:"myCreatBug menu-icon"},[r("i",{staticClass:"fa fa-bug bug-i",attrs:{"aria-hidden":"true"}}),e._v(" "),r("i",{staticClass:"fa fa-plus plus-i",attrs:{"aria-hidden":"true"}})])]),e._v(" "),r("span",{staticClass:"menu-title"},[e._v("我创建的Bug")])]),e._v(" "),r("el-menu-item",{attrs:{index:"/bug/myDispose"}},[r("div",{staticClass:"menu-icon-div"},[r("div",{staticClass:"myCreatBug menu-icon"},[r("i",{staticClass:"fa fa-bug",staticStyle:{color:"#0aae54","font-size":"35px",position:"absolute",left:"8px"},attrs:{"aria-hidden":"true"}})])]),e._v(" "),r("span",{staticClass:"menu-title"},[e._v("分配给我的Bug")])]),e._v(" "),r("el-menu-item",{attrs:{index:"/bug/situation"}},[r("div",{staticClass:"menu-icon-div"},[r("i",{staticClass:"fa fa-home menu-icon",staticStyle:{color:"rgb(10, 174, 84)"},attrs:{"aria-hidden":"true"}})]),e._v(" "),r("span",{staticClass:"menu-title"},[e._v("项目概况")])])],1)],1)],1),e._v(" "),r("div",[r("el-dialog",{attrs:{title:"新建BUG",visible:e.dialogCreatBugVisible,width:"80%"},on:{"update:visible":function(t){e.dialogCreatBugVisible=t},open:e.dialogCreatBugVisibleOpen,close:e.dialogCreatBugVisibleClose}},[r("div",{staticClass:"announcement-content"},[r("el-form",{ref:"numberValidateForm",staticClass:"demo-ruleForm",attrs:{model:e.creatBug_form,"label-width":"90px",rules:e.rules3,"inline-message":!0}},[r("el-form-item",{staticStyle:{margin:"0px"},attrs:{label:"标题",prop:"BugTitle",rules:[{required:!0,message:"标题不能为空",trigger:"blur"}]}},[r("el-input",{attrs:{type:"age",size:"mini","auto-complete":"off"},model:{value:e.creatBug_form.BugTitle,callback:function(t){e.$set(e.creatBug_form,"BugTitle",t)},expression:"creatBug_form.BugTitle"}})],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"0px"},attrs:{label:"版本",prop:"ProjectVerID",rules:[{required:!0,message:"请选择版本",trigger:"change"}]}},[r("el-select",{attrs:{placeholder:"请选择版本",size:"small"},model:{value:e.creatBug_form.ProjectVerID,callback:function(t){e.$set(e.creatBug_form,"ProjectVerID",t)},expression:"creatBug_form.ProjectVerID"}},e._l(e.ProjectVer_options,function(e){return r("el-option",{key:e.ProjectVerID,attrs:{label:e.ProjectVerNO,value:e.ProjectVerID}})}))],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"0px"},attrs:{label:"模块",prop:"ModuleID",rules:[{required:!0,message:"请选择模块",trigger:"change"}]}},[r("el-select",{attrs:{placeholder:"请选择模块",size:"small"},model:{value:e.creatBug_form.ModuleID,callback:function(t){e.$set(e.creatBug_form,"ModuleID",t)},expression:"creatBug_form.ModuleID"}},e._l(e.Module_options,function(e){return r("el-option",{key:e.ModuleID,attrs:{label:e.ModuleName,value:e.ModuleID}})}))],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"0px"},attrs:{label:"优先级"}},[r("el-radio-group",{model:{value:e.creatBug_form.PriorityLevel,callback:function(t){e.$set(e.creatBug_form,"PriorityLevel",t)},expression:"creatBug_form.PriorityLevel"}},[r("el-radio",{attrs:{label:"低"}},[e._v("低")]),e._v(" "),r("el-radio",{attrs:{label:"中"}},[e._v("中")]),e._v(" "),r("el-radio",{attrs:{label:"高"}},[e._v("高")]),e._v(" "),r("el-radio",{attrs:{label:"紧急"}},[e._v("紧急")]),e._v(" "),r("el-radio",{attrs:{label:"严重"}},[e._v("严重")])],1)],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"0px",display:"inline-block"},attrs:{label:"处理人",prop:"ProcessingPerson",rules:[{required:!0,message:"请选择处理人",trigger:"change"}]}},[r("el-select",{attrs:{placeholder:"请选择处理人",size:"small"},model:{value:e.creatBug_form.ProcessingPerson,callback:function(t){e.$set(e.creatBug_form,"ProcessingPerson",t)},expression:"creatBug_form.ProcessingPerson"}},e._l(e.ProcessingPerson_options,function(e){return r("el-option",{key:e.MemberID,attrs:{label:e.EmployeeNickName,value:e.EmployeeID}})}))],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"0px",display:"inline-block"},attrs:{prop:"NeedTime","label-width":"20px"}},[r("span",{staticStyle:{color:"red"}},[e._v("处理所需时间： ")]),e._v(" "),r("el-input",{staticStyle:{width:"130px"},attrs:{size:"small"},model:{value:e.creatBug_form.NeedTime,callback:function(t){e.$set(e.creatBug_form,"NeedTime",t)},expression:"creatBug_form.NeedTime"}}),e._v("\n                        小时\n                    ")],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"0px",display:"inline-block","margin-left":"10px"},attrs:{label:"任务类别：",prop:"TaskType","label-width":"90px"}},[r("div",{staticClass:"task-categories-div"},[r("el-radio-group",{model:{value:e.creatBug_form.TaskType,callback:function(t){e.$set(e.creatBug_form,"TaskType",t)},expression:"creatBug_form.TaskType"}},[r("el-radio",{attrs:{label:"开发"}},[e._v("开发")]),e._v(" "),r("el-radio",{attrs:{label:"修复"}},[e._v("修复")]),e._v(" "),r("el-radio",{attrs:{label:"测试"}},[e._v("测试")])],1)],1)]),e._v(" "),r("el-form-item",{staticStyle:{margin:"0px"},attrs:{label:"描述与截图"}},[r("div",{staticStyle:{"padding-top":"10px"}},[r("rte",{attrs:{upload_url:e.baseUrl+"/Services/FilesUploadService.ashx",upload_file_path:e.baseUrl+"/uploads"},model:{value:e.creatBug_form.describeImageCotent,callback:function(t){e.$set(e.creatBug_form,"describeImageCotent",t)},expression:"creatBug_form.describeImageCotent"}})],1)]),e._v(" "),r("el-form-item",{staticStyle:{margin:"0px"}},[r("div",[r("el-checkbox",{model:{value:e.isSendAllPeople,callback:function(t){e.isSendAllPeople=t},expression:"isSendAllPeople"}},[e._v("发送邮件到项目所有成员")])],1),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.bugSubmit("numberValidateForm")}}},[e._v("提交\n                        ")])],1)],1)],1)])],1),e._v(" "),r("router-view")],1)},staticRenderFns:[]};var u=a("C7Lr")(n,c,!1,function(e){a("hVKM")},"data-v-0210a82e",null);t.default=u.exports},IjQa:function(e,t,a){var r=a("FITv"),i=a("C02x").isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},Mhc3:function(e,t,a){e.exports={default:a("0czL"),__esModule:!0}},hVKM:function(e,t){}});
//# sourceMappingURL=5.8174a28e08ca91dee9ab.js.map