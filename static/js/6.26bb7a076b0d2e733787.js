webpackJsonp([6],{"6vIR":function(e,t){},uLcj:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("3cXf"),s=a.n(o),n={name:"my-team",data:function(){return{baseUrl:this.$intfcUrl,IsAdministor:JSON.parse(localStorage.getItem("Bug_LoginUser")).IsAdministor,Loginer_Account:JSON.parse(localStorage.getItem("Bug_LoginUser")).EmployeeAccount,team_data:[],dialogAddTeamVisible:!1,dialogEditTeamVisible:!1,addTeamForm:{Logo:"",Telephone:"",Contacts:""},editTeamForm:{Logo:"",Telephone:"",Contacts:""},current_expand_count:0,loading:!0}},mounted:function(){this.GetMyTeam()},methods:{isAdministorChange:function(e,t){var a=t.target.parentNode.parentNode.dataset.employeeaccount;this.IsAdministrator(e?1:0,a)},IsAdministrator:function(e,t){var a=this;a.$http.post(a.baseUrl+"/Services/BugManageServices.ashx",{method:"IsAdministrator",IsTrue:e,EmployeeAccount:t}).then(function(e){e.data.code>0?a.$message({message:"修改成功",type:"success"}):a.$message({message:"修改失败",type:"error"})}).catch(function(e){a.$message({message:"修改失败",type:"error"})})},expandChange:function(e,t){t.length>this.current_expand_count&&this.GetTeamPerson(e.TeamID,e.index),this.current_expand_count=t.length},openAddTeam:function(){this.dialogAddTeamVisible=!0},openEditTeam:function(e){this.editTeamForm=JSON.parse(s()(e)),this.dialogEditTeamVisible=!0},GetMyTeam:function(){var e=this;sessionStorage.getItem("EmployeeInfo")?(e.loading=!0,e.$http.get(e.baseUrl+"/static/data/GetMyTeam.json",{params:{CompanyCode:JSON.parse(sessionStorage.getItem("EmployeeInfo")).CompanyCode}}).then(function(t){e.loading=!1,t.data.code>0&&(t.data.data.forEach(function(e,t){e.index=t,e.TeamPersonData=[]}),e.team_data=t.data.data)}).catch(function(e){})):(e.$message({message:"登录已超时，请重新登录",type:"error"}),e.$router.push("/login"))},GetTeamPerson:function(e,t){var a=this;a.$http.get(a.baseUrl+"/static/data/GetTeamPerson.json",{params:{TeamID:e}}).then(function(o){if(o.data.code>0){var s=o.data.data,n="";a.team_data.forEach(function(t,a){t.TeamID==e&&(n=t.Account)}),s.forEach(function(e,t){e.Account=n}),a.team_data[t].TeamPersonData=s}else a.team_data[t].TeamPersonData=[]}).catch(function(e){})},submitAddTeamForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.AddMyTeam()})},submitEditTeamForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.Modify_MyTeam()})},AddMyTeam:function(){var e=this;e.$http.post(e.baseUrl+"/Services/BugManageServices.ashx",{method:"AddMyTeam",jsondata:s()(e.addTeamForm)}).then(function(t){t.data.code>0?(e.GetMyTeam(),e.dialogAddTeamVisible=!1,e.$message({message:"添加成功",type:"success"})):e.$message({message:"添加失败，请重试",type:"error"})}).catch(function(t){e.$message({message:"添加失败，请重试",type:"error"})})},Modify_MyTeam:function(){var e=this;e.$http.post(e.baseUrl+"/Services/BugManageServices.ashx",{method:"Modify_MyTeam",jsondata:s()(e.editTeamForm)}).then(function(t){t.data.code>0?(e.GetMyTeam(),e.dialogEditTeamVisible=!1,e.$message({message:"修改成功",type:"success"})):e.$message({message:"修改失败，请重试",type:"error"})}).catch(function(t){e.$message({message:"修改失败，请重试",type:"error"})})},DeleteTeamPersonEV:function(e,t){var a=this;a.$confirm("确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.DeleteTeamPerson(e,t)}).catch(function(){})},DeleteTeamPerson:function(e,t){var a=this;a.$http.post(a.baseUrl+"/Services/BugManageServices.ashx",{method:"DeleteTeamPerson",PersonDetailID:e.PersonDetailID}).then(function(o){o.data.code>0?(a.GetTeamPerson(e.TeamID,t),a.$message({message:"删除成功",type:"success"})):a.$message({message:"删除失败，请重试",type:"error"})}).catch(function(e){a.$message({message:"删除失败，请重试",type:"error"})})},AddTeamPersonEV:function(e){this.AddTeamPerson(e)},AddTeamPerson:function(e){var t=this,a="EmployeeAccount"+e.TeamID,o=t.$refs[a].$refs.input.value;o?new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$").test(o)?t.$http.post(t.baseUrl+"/Services/BugManageServices.ashx",{method:"AddTeamPerson",TeamID:e.TeamID,EmployeeAccount:o}).then(function(a){a.data.code>0?(t.GetTeamPerson(e.TeamID,e.index),t.$message({message:"添加成功",type:"success"})):t.$message({message:a.data.error,type:"error"})}).catch(function(e){t.$message({message:"添加失败，请重试",type:"error"})}):t.$message({message:"帐号必须是邮箱，请确认",type:"error"}):t.$message({message:"人员帐号不能为空",type:"error"})}},filters:{dateFormat:a("MQ2Q").dateFormat}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"padding-top":"20px"}},[a("el-card",{staticStyle:{margin:"10px"}},[a("div",[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{"font-weight":"600"}},[e._v("我的团队")])]),e._v(" "),a("el-col",{staticStyle:{"text-align":"right","padding-right":"10px"},attrs:{span:6}},["是"==e.IsAdministor?a("el-button",{attrs:{type:"primary"},on:{click:e.openAddTeam}},[e._v("创建团队")]):e._e()],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"98%"},attrs:{data:e.team_data},on:{"expand-change":e.expandChange}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{flex:"1"}},[a("el-table",{attrs:{data:t.row.TeamPersonData}},[a("el-table-column",{attrs:{prop:"EmployeeNickName",label:"昵称",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"EmployeeAccount",label:"人员帐号",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"JoinDate",label:"加入时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("dateFormat")(t.row.JoinDate)))])]}}])}),e._v(" "),"是"==e.IsAdministor?a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(o){return[a("el-button",{attrs:{size:"mini",type:"danger",plain:"",disabled:o.row.EmployeeAccount==o.row.Account||o.row.EmployeeAccount==e.Loginer_Account},on:{click:function(a){e.DeleteTeamPersonEV(o.row,t.row.index)}}},[e._v("删除\n                                            ")])]}}])}):e._e(),e._v(" "),"是"==e.IsAdministor?a("el-table-column",{attrs:{label:"管理员",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{attrs:{"data-EmployeeAccount":t.row.EmployeeAccount,disabled:t.row.EmployeeAccount==t.row.Account||t.row.EmployeeAccount==e.Loginer_Account},on:{change:e.isAdministorChange},model:{value:t.row.IsAdministor,callback:function(a){e.$set(t.row,"IsAdministor",a)},expression:"propss.row.IsAdministor"}})]}}])}):e._e()],1)],1),e._v(" "),"是"==e.IsAdministor?a("div",{staticStyle:{flex:"1",padding:"20px"}},[a("el-input",{ref:"EmployeeAccount"+t.row.TeamID,staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"人员帐号"}}),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.AddTeamPersonEV(t.row)}}},[e._v("添加成员\n                                ")])],1):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"TeamName",label:"团队名称",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Logo",label:"Logo",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Contacts",label:"地址"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Telephone",label:"联系方式"}}),e._v(" "),"是"==e.IsAdministor?a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.openEditTeam(t.row)}}},[e._v("编辑")])]}}])}):e._e()],1)],1)],1),e._v(" "),a("div",[a("el-dialog",{attrs:{title:"添加团队",visible:e.dialogAddTeamVisible},on:{"update:visible":function(t){e.dialogAddTeamVisible=t}}},[a("el-form",{ref:"addTeamForm",staticClass:"demo-ruleForm",staticStyle:{width:"370px",margin:"0 auto"},attrs:{model:e.addTeamForm,"status-icon":"","label-width":"80px"}},[a("el-form-item",{attrs:{label:"团队名称",prop:"TeamName",rules:[{required:!0,message:"团队名称不能为空",trigger:"blur"}]}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addTeamForm.TeamName,callback:function(t){e.$set(e.addTeamForm,"TeamName",t)},expression:"addTeamForm.TeamName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Logo",prop:"pass"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addTeamForm.Logo,callback:function(t){e.$set(e.addTeamForm,"Logo",t)},expression:"addTeamForm.Logo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系人",prop:"pass"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addTeamForm.Contacts,callback:function(t){e.$set(e.addTeamForm,"Contacts",t)},expression:"addTeamForm.Contacts"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话",prop:"Telephone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addTeamForm.Telephone,callback:function(t){e.$set(e.addTeamForm,"Telephone",e._n(t))},expression:"addTeamForm.Telephone"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitAddTeamForm("addTeamForm")}}},[e._v("提交")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑团队",visible:e.dialogEditTeamVisible},on:{"update:visible":function(t){e.dialogEditTeamVisible=t}}},[a("el-form",{ref:"editTeamForm",staticClass:"demo-ruleForm",staticStyle:{width:"370px",margin:"0 auto"},attrs:{model:e.editTeamForm,"status-icon":"","label-width":"80px"}},[a("el-form-item",{attrs:{label:"团队名称",prop:"TeamName",rules:[{required:!0,message:"团队名称不能为空",trigger:"blur"}]}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editTeamForm.TeamName,callback:function(t){e.$set(e.editTeamForm,"TeamName",t)},expression:"editTeamForm.TeamName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Logo",prop:"pass"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editTeamForm.Logo,callback:function(t){e.$set(e.editTeamForm,"Logo",t)},expression:"editTeamForm.Logo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系人",prop:"pass"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editTeamForm.Contacts,callback:function(t){e.$set(e.editTeamForm,"Contacts",t)},expression:"editTeamForm.Contacts"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话",prop:"checkPass"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editTeamForm.Telephone,callback:function(t){e.$set(e.editTeamForm,"Telephone",t)},expression:"editTeamForm.Telephone"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitEditTeamForm("editTeamForm")}}},[e._v("提交")])],1)],1)],1)],1)])},staticRenderFns:[]};var i=a("C7Lr")(n,r,!1,function(e){a("6vIR")},"data-v-ea701912",null);t.default=i.exports}});
//# sourceMappingURL=6.26bb7a076b0d2e733787.js.map