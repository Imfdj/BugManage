webpackJsonp([13],{P7ry:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("3cXf"),s=r.n(o),a={name:"login",data:function(){return{baseUrl:this.$intfcUrl,loginForm:{UserName:null,Password:null},dialogRegisterVisible:!1,registerForm:{CompanyContacts:"",CompanyAddress:"",CompanyTelephone:""},checkedPwd:!1}},beforeMount:function(){var e=JSON.parse(localStorage.getItem("Bug_LoginUser"));e&&(this.loginForm.UserName=e.EmployeeAccount,this.loginForm.Password=e.EmployeePassword,this.checkedPwd=e.checkedPwd)},methods:{openRegister:function(){this.dialogRegisterVisible=!0},submitRegisterForm:function(e){var t=this;t.$refs[e].validate(function(e){e&&t.$http.post(t.baseUrl+"/Services/registerServer.ashx",{method:"AddCompanyInfo",jsondata:t.registerForm}).then(function(e){e.data.code>0?(t.dialogRegisterVisible=!1,t.$message({message:"注册成功",type:"success"})):"该公司已经存在！"==e.data.data?t.$message({message:"公司编号已存在",type:"error"}):t.$message({message:"帐号已存在",type:"error"})}).catch(function(e){t.$message({message:"服务器繁忙，请稍候再试",type:"error"})})})},submitForm:function(e){var t=this;t.$refs[e].validate(function(e){e&&t.$http.get(t.baseUrl+"/static/data/user.json",{params:{UserName:t.loginForm.UserName,Password:t.loginForm.Password}}).then(function(e){if(e.data.EmployeeInfo){if(e.data.EmployeeInfo.CompanyCode){var r=e.data.EmployeeInfo,o=sessionStorage.getItem("lastPath");sessionStorage.setItem("EmployeeInfo",s()(e.data.EmployeeInfo)),localStorage.setItem("EmployeeInfo",s()(e.data.EmployeeInfo)),t.checkedPwd?(r.EmployeePassword=t.loginForm.Password,r.checkedPwd=!0):(r.EmployeePassword=null,r.checkedPwd=!1),localStorage.setItem("Bug_LoginUser",s()(r)),o?(t.$router.push(o),sessionStorage.removeItem("lastPath")):t.$router.push("/projectList")}}else t.$message({message:"帐号或是密码错误",type:"error"})}).catch(function(e){t.$message({message:"服务器繁忙，请稍候再试",type:"error"})})})}}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"login-wrap"},[r("div",{staticClass:"login-title"},[e._v("系统登录")]),e._v(" "),r("el-form",{ref:"loginFormEl",staticClass:"demo-ruleForm",staticStyle:{width:"370px"},attrs:{model:e.loginForm,"status-icon":"","label-width":"70px"}},[r("el-form-item",{attrs:{label:"帐号",prop:"UserName",rules:[{required:!0,message:"请输入帐号",trigger:"blur"}]}},[r("el-input",{attrs:{type:"text","auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("loginFormEl")}},model:{value:e.loginForm.UserName,callback:function(t){e.$set(e.loginForm,"UserName",t)},expression:"loginForm.UserName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"Password",rules:[{required:!0,message:"请输入密码",trigger:"blur"}]}},[r("el-input",{attrs:{type:"password","auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("loginFormEl")}},model:{value:e.loginForm.Password,callback:function(t){e.$set(e.loginForm,"Password",t)},expression:"loginForm.Password"}}),e._v(" "),r("el-checkbox",{model:{value:e.checkedPwd,callback:function(t){e.checkedPwd=t},expression:"checkedPwd"}},[e._v("记住密码")])],1),e._v(" "),r("el-form-item",[r("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){e.submitForm("loginFormEl")}}},[e._v("登录")])],1),e._v(" "),r("el-form-item",[r("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.openRegister}},[e._v("注册")])],1)],1)],1),e._v(" "),r("div",[r("el-dialog",{attrs:{title:"注册",visible:e.dialogRegisterVisible},on:{"update:visible":function(t){e.dialogRegisterVisible=t}}},[r("el-form",{ref:"registerForm",staticClass:"demo-ruleForm",staticStyle:{width:"370px",margin:"0 auto"},attrs:{model:e.registerForm,"status-icon":"","label-width":"80px"}},[r("el-form-item",{attrs:{label:"邮箱账号",prop:"AdministratorAccount",rules:[{required:!0,message:"请输入邮箱账号",trigger:"blur"},{type:"email",message:"格式有误",trigger:"blur"}]}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.registerForm.AdministratorAccount,callback:function(t){e.$set(e.registerForm,"AdministratorAccount",t)},expression:"registerForm.AdministratorAccount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"AdministratorPassword",rules:[{required:!0,message:"请输入密码",trigger:"blur"}]}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.registerForm.AdministratorPassword,callback:function(t){e.$set(e.registerForm,"AdministratorPassword",t)},expression:"registerForm.AdministratorPassword"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"公司名称",prop:"CompanyName",rules:[{required:!0,message:"请输入公司名称",trigger:"blur"}]}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.registerForm.CompanyName,callback:function(t){e.$set(e.registerForm,"CompanyName",t)},expression:"registerForm.CompanyName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"公司编号",prop:"CompanyCode",rules:[{required:!0,message:"请输入公司编号",trigger:"blur"}]}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.registerForm.CompanyCode,callback:function(t){e.$set(e.registerForm,"CompanyCode",t)},expression:"registerForm.CompanyCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"联系人",prop:"checkPass"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.registerForm.CompanyContacts,callback:function(t){e.$set(e.registerForm,"CompanyContacts",t)},expression:"registerForm.CompanyContacts"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"地址",prop:"checkPass"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.registerForm.CompanyAddress,callback:function(t){e.$set(e.registerForm,"CompanyAddress",t)},expression:"registerForm.CompanyAddress"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"电话",prop:"checkPass"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.registerForm.CompanyTelephone,callback:function(t){e.$set(e.registerForm,"CompanyTelephone",t)},expression:"registerForm.CompanyTelephone"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitRegisterForm("registerForm")}}},[e._v("提交")])],1)],1)],1)],1)])},staticRenderFns:[]};var l=r("C7Lr")(a,i,!1,function(e){r("ktVE")},"data-v-13f2a9d1",null);t.default=l.exports},ktVE:function(e,t){}});
//# sourceMappingURL=13.d8129b7d230cb0c7b6b5.js.map